#!/usr/bin/env python

import argparse
import fakemake as fm

def run_main():
    args = parse_args()

    if args.yaml != None:
        #process a fakemake file
        pipeline = fm.parse_yaml(args.yaml)
        config = fm.setup_config(pipeline)
        fm.process(config,pipeline)

    elif args.qsub != None:
        #carry out a job on a compute node spawned from qsub (gridengine)
        fm.qsub(args.qsub)

def parse_args():
    parser = argparse.ArgumentParser()
    parser.add_argument('--yaml',default=None)
    parser.add_argument('--qsub',default=None)
    args = parser.parse_args()
    return args

if __name__ == "__main__":
    run_main()
